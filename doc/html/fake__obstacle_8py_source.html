<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>tamu_sa: fake_obstacle.py Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="jquery.js"></script>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_8637afc38b758fdb535647a385c49b5e.html">nodes</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">fake_obstacle.py</div>  </div>
</div><!--header-->
<div class="contents">
<a href="fake__obstacle_8py.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="namespacefake__obstacle.html">    1</a></span>&#160;<span class="comment">#!/usr/bin/env python</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="stringliteral">&quot;&quot;&quot;This ROS node allows the user to publish moving/stationary/pop-up obstacles, using &lt;ObjectDetectArray&gt; message type</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">import</span> rospy</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="keyword">from</span> tamu_sa.msg <span class="keyword">import</span> ObjectDetectArray, ObjectDetect</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">import</span> pdb</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="classfake__obstacle_1_1FakeObstacles.html">   12</a></span>&#160;<span class="keyword">class </span><a class="code" href="classfake__obstacle_1_1FakeObstacles.html">FakeObstacles</a>:</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Helper class for creating ObstacleDetectArray elements</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="stringliteral">                Contact Tianqi for updates to the ROS MESSAGE</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="stringliteral">                Variables:</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="stringliteral">                        objectArrayDict (dict): A collection of &#39;ObjectDetect&#39;, which will be returned!</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="classfake__obstacle_1_1FakeObstacles.html#adfbd206d9166bbbd6b1691ed596f913c">   21</a></span>&#160;        objectArrayDict = {}</div><div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="classfake__obstacle_1_1FakeObstacles.html#a1189f302b19149deee3851c3e32e16a4">   22</a></span>&#160;        obstacleCache = {}</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <span class="comment"># def __init__(self, easting, northing, id, bb_height, bb_width, obj_confidence, type_=&quot;ST&quot;):</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <span class="comment">#       # cur_det = ObjectDetect()</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <span class="comment">#       # cur_det.easting = 100</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <span class="comment">#       # cur_det.northing = 300</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="comment">#       # cur_det.id = 134</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="comment">#       # cur_det.bb_height = 25</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="comment">#       # cur_det.bb_width = 25</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="comment">#       # cur_det.obj_confidence = 1</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <span class="comment">#       self.newObject = ObjectDetect()</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <span class="comment">#       self.newObject.easting = easting</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <span class="comment">#       self.newObject.northing = northing</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <span class="comment">#       self.newObject.id = id</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="comment">#       self.newObject.bb_height = bb_height</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="comment">#       self.newObject.bb_width = bb_width</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="comment">#       self.newObject.obj_confidence = obj_confidence</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="comment">#       self.init_easting = easting</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="comment">#       self.init_northing = northing</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="comment">#       self.type_ = type_</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="comment">#       #objectArrayMsg.detections.append(self.newObject)</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="comment">#       #objectArrayDict[id] = self.newObject</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="comment">#               # Keep track of obstacles</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="comment">#               cls._add_obstacles(id, self.newObject, type_)</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        @classmethod</div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="classfake__obstacle_1_1FakeObstacles.html#a3c40447c05bf3f0b66600278575fdadc">   51</a></span>&#160;        <span class="keyword">def </span><a class="code" href="classfake__obstacle_1_1FakeObstacles.html#a3c40447c05bf3f0b66600278575fdadc">add_obstacles</a>(cls,  easting,        northing,       id,     bb_height,      bb_width,       obj_confidence, type_, **kwargs):</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                <span class="stringliteral">&quot;&quot;&quot;Class method to add obstacles</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="stringliteral">                Parameters:</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="stringliteral">                        easting (float, int): Center coordinate of the bounding box</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="stringliteral">                        northing (float, int): Center coordinate of the bounding box</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="stringliteral">                        id (int): Detected object&#39;s id number</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="stringliteral">                        bb_height (float, int): Heigh of bounding box</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="stringliteral">                        bb_width (float, int): Width of bounding box</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="stringliteral">                        obj_confidence(float): Confidence detection is valid, interval in [0-1]</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="stringliteral">                        type_ (str): &quot;MLR&quot;, &quot;MUD&quot;, &quot;ST&quot;, &quot;POP&quot; (not part of the messages!)</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="stringliteral">                        **kwargs: For arbitrary additional keyworded inputs</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="stringliteral">                &quot;&quot;&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                newObject = ObjectDetect()</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                newObject.easting = easting</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                newObject.northing = northing</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                newObject.id = id</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                newObject.bb_height = bb_height</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                newObject.bb_width = bb_width</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                newObject.obj_confidence = obj_confidence</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                init_easting = easting</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                init_northing = northing</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                type_ = type_</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                cls.<a class="code" href="classfake__obstacle_1_1FakeObstacles.html#ad4c5a91714247afb01b02cd30e2bd8e2">_add_obstacles</a>(id, newObject, type_, init_easting, init_northing, kwargs)</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        @classmethod</div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="classfake__obstacle_1_1FakeObstacles.html#ad4c5a91714247afb01b02cd30e2bd8e2">   80</a></span>&#160;        <span class="keyword">def </span><a class="code" href="classfake__obstacle_1_1FakeObstacles.html#ad4c5a91714247afb01b02cd30e2bd8e2">_add_obstacles</a>(cls, id, object, type_, init_e, init_n, kwargs):</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                cls.<a class="code" href="classfake__obstacle_1_1FakeObstacles.html#adfbd206d9166bbbd6b1691ed596f913c">objectArrayDict</a>[id] = {<span class="stringliteral">&#39;obj&#39;</span>:{<span class="stringliteral">&#39;msg&#39;</span>: object, <span class="stringliteral">&#39;init_e&#39;</span>: init_e, <span class="stringliteral">&#39;init_n&#39;</span>: init_n }, <span class="stringliteral">&#39;return&#39;</span>: <span class="keyword">True</span>, <span class="stringliteral">&#39;type&#39;</span>: type_, <span class="stringliteral">&#39;args&#39;</span>: kwargs}</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        @classmethod</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="classfake__obstacle_1_1FakeObstacles.html#ae8861060d762f4b351bedc1e49e7a435">   84</a></span>&#160;        <span class="keyword">def </span><a class="code" href="classfake__obstacle_1_1FakeObstacles.html#ae8861060d762f4b351bedc1e49e7a435">update_objects</a>(cls, time):</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                <span class="stringliteral">&quot;&quot;&quot;Apply motion model to our obstacles if relevant</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="stringliteral">                Parameter:</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="stringliteral">                time (float): Current clock (elapsed since start)</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="stringliteral">                &quot;&quot;&quot;</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                <span class="keywordflow">for</span> k <span class="keywordflow">in</span> cls.<a class="code" href="classfake__obstacle_1_1FakeObstacles.html#adfbd206d9166bbbd6b1691ed596f913c">objectArrayDict</a>.values():</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                        <span class="keywordflow">if</span> k[<span class="stringliteral">&#39;type&#39;</span>] <span class="keywordflow">is</span> <span class="stringliteral">&#39;MLR&#39;</span>:</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                                cls.<a class="code" href="classfake__obstacle_1_1FakeObstacles.html#a03901b0c226c1ef5cc7ee11146ac0571">use_motion_model_x</a>(k[<span class="stringliteral">&#39;obj&#39;</span>], time, **k[<span class="stringliteral">&#39;args&#39;</span>])</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                        <span class="keywordflow">elif</span> k[<span class="stringliteral">&#39;type&#39;</span>] <span class="keywordflow">is</span> <span class="stringliteral">&#39;MUD&#39;</span>:</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                cls.<a class="code" href="classfake__obstacle_1_1FakeObstacles.html#a3877a418deb713aa4efcd37cdb9cee74">use_motion_model_y</a>(k[<span class="stringliteral">&#39;obj&#39;</span>], time, **k[<span class="stringliteral">&#39;args&#39;</span>])</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                        <span class="keywordflow">elif</span> k[<span class="stringliteral">&#39;type&#39;</span>] <span class="keywordflow">is</span> <span class="stringliteral">&#39;ST&#39;</span>:</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                <span class="keywordflow">pass</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                        <span class="keywordflow">elif</span> k[<span class="stringliteral">&#39;type&#39;</span>] <span class="keywordflow">is</span> <span class="stringliteral">&#39;POP&#39;</span>:</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                cls.<a class="code" href="classfake__obstacle_1_1FakeObstacles.html#a3bc0716dd29c3064e86bd463710dc38c">pop_up</a>(k, time, k[<span class="stringliteral">&#39;args&#39;</span>][<span class="stringliteral">&#39;tAppear&#39;</span>])</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                msg = cls.<a class="code" href="classfake__obstacle_1_1FakeObstacles.html#a3831a191cf1cc8a1edf95b67dac41903">return_object_array</a>()</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                <span class="keywordflow">return</span> msg</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        </div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        @staticmethod</div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="classfake__obstacle_1_1FakeObstacles.html#a03901b0c226c1ef5cc7ee11146ac0571">  107</a></span>&#160;        <span class="keyword">def </span><a class="code" href="classfake__obstacle_1_1FakeObstacles.html#a03901b0c226c1ef5cc7ee11146ac0571">use_motion_model_x</a>(obstacle, t, period=None, amplitude=None):</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                <span class="stringliteral">&quot;&quot;&quot;Function to move obstacle left-right&quot;&quot;&quot;</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                <span class="comment"># move left/right 25 meters</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                new_x = amplitude*np.sin(2*np.pi/period*t)</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                obstacle[<span class="stringliteral">&#39;msg&#39;</span>].easting = new_x + obstacle[<span class="stringliteral">&#39;init_e&#39;</span>]</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        @staticmethod</div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="classfake__obstacle_1_1FakeObstacles.html#a3877a418deb713aa4efcd37cdb9cee74">  114</a></span>&#160;        <span class="keyword">def </span><a class="code" href="classfake__obstacle_1_1FakeObstacles.html#a3877a418deb713aa4efcd37cdb9cee74">use_motion_model_y</a>(obstacle, t, period=None, amplitude=None):</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                <span class="stringliteral">&quot;&quot;&quot;Function to move obstacle up-down&quot;&quot;&quot;</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                <span class="comment"># move up and down 25 meters</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                new_y = amplitude*np.sin(2*np.pi/period*t)</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                obstacle[<span class="stringliteral">&#39;msg&#39;</span>].northing = new_y + obstacle[<span class="stringliteral">&#39;init_n&#39;</span>]</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        </div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        @classmethod</div><div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="classfake__obstacle_1_1FakeObstacles.html#a3bc0716dd29c3064e86bd463710dc38c">  123</a></span>&#160;        <span class="keyword">def </span><a class="code" href="classfake__obstacle_1_1FakeObstacles.html#a3bc0716dd29c3064e86bd463710dc38c">pop_up</a>(cls, f_obstacle, t, tAppear=None):</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                <span class="stringliteral">&quot;&quot;&quot;Obstacle will pop up after some time &quot;&quot;&quot;</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                <span class="comment"># After tAppear seconds, add the obstacles to objectArrayDict = {}</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                <span class="keywordflow">if</span> t &gt; tAppear:</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                        <span class="comment"># if f_obstacle[&#39;obj&#39;][&#39;msg&#39;].id in cls.obstacleCache:</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                        <span class="comment">#       cls.add_object(f_obstacle[&#39;msg&#39;].id, f_obstacle)</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                        <span class="comment">#       del cls.obstacleCache[f_obstacle.newObject.id]</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                        f_obstacle[<span class="stringliteral">&#39;return&#39;</span>] = <span class="keyword">True</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                        <span class="comment"># Before tAppear, make sure obstacle hasn&#39;t appeared in objectArrayDict</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                        <span class="comment"># if f_obstacle[&#39;obj&#39;][&#39;msg&#39;].id in cls.objectArrayDict:</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                        <span class="comment">#       cls.obstacleCache[f_obstacle[&#39;obj&#39;][&#39;msg&#39;].id] = f_obstacle</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                        <span class="comment">#       cls.delete_object(f_obstacle[&#39;obj&#39;][&#39;msg&#39;].id)</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                        <span class="comment">#       print(&quot;wip&quot;)</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                        f_obstacle[<span class="stringliteral">&#39;return&#39;</span>] = <span class="keyword">False</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="comment"># @classmethod</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="comment"># def delete_object(cls,id):</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="comment">#       del cls.objectArrayDict[id]</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="comment"># @classmethod</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="comment"># def add_object(cls,id, f_obstacles):</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="comment">#       cls.objectArrayDict[id] = f_obstacles</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        </div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        @classmethod</div><div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="classfake__obstacle_1_1FakeObstacles.html#a3831a191cf1cc8a1edf95b67dac41903">  151</a></span>&#160;        <span class="keyword">def </span><a class="code" href="classfake__obstacle_1_1FakeObstacles.html#a3831a191cf1cc8a1edf95b67dac41903">return_object_array</a>(cls):</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                <span class="stringliteral">&quot;&quot;&quot; Construct message for publishing &quot;&quot;&quot;</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                msg = ObjectDetectArray()</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                <span class="comment"># msg.detections = list(cls.objectArrayDict.values())</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="keywordflow">for</span> k <span class="keywordflow">in</span> cls.<a class="code" href="classfake__obstacle_1_1FakeObstacles.html#adfbd206d9166bbbd6b1691ed596f913c">objectArrayDict</a>.values():</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                        <span class="keywordflow">if</span> k[<span class="stringliteral">&#39;return&#39;</span>] == <span class="keyword">True</span>:</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                msg.detections.append(k[<span class="stringliteral">&#39;obj&#39;</span>][<span class="stringliteral">&#39;msg&#39;</span>])</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                <span class="keywordflow">return</span> msg</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="classfake__obstacle_1_1FakeObstacleNode.html">  160</a></span>&#160;<span class="keyword">class </span><a class="code" href="classfake__obstacle_1_1FakeObstacleNode.html">FakeObstacleNode</a>:</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;ROS Node which allows the user to set obstacles</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="stringliteral">        Attributes:</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="stringliteral">        objPub (rospy.Publisher): A ROS object for publishing message of type &#39;ObjectDetectArray&#39;</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="stringliteral">        Parameters:</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="stringliteral">        fakeOstacles (FakeObstacles): Expects &#39;FakeObstacles&#39; class!</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="stringliteral">        topic_name (str): A string denoting the published topic&#39;s name</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="classfake__obstacle_1_1FakeObstacleNode.html#a85cf0f3e284aa663868e1acd3dd7b999">  171</a></span>&#160;        <span class="keyword">def </span><a class="code" href="classfake__obstacle_1_1FakeObstacleNode.html#a85cf0f3e284aa663868e1acd3dd7b999">__init__</a>(self, fakeObstacles, topic_name=&quot;/test/object_detection&quot;):</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                <span class="comment"># create publisher</span></div><div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="classfake__obstacle_1_1FakeObstacleNode.html#afbcab1ee35760168a9ff7b708117e7f3">  174</a></span>&#160;                self.<a class="code" href="classfake__obstacle_1_1FakeObstacleNode.html#afbcab1ee35760168a9ff7b708117e7f3">objPub</a> = rospy.Publisher(topic_name, ObjectDetectArray, queue_size=1)</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                <span class="comment"># set loop rate</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                rate = rospy.Rate(10)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                <span class="comment"># Not ru the while loop</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                initTime = rospy.get_time()</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                <span class="keywordflow">while</span> <span class="keywordflow">not</span> rospy.is_shutdown():</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                        timeNow = rospy.get_time() - initTime</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                        <span class="comment"># self.use_motion_model_x(obstacle1, timeNow, 10, 25)</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                        <span class="comment"># self.use_motion_model_y(obstacle2, timeNow, 10, 25)</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                        <span class="comment"># self.pop_up(obstacle2, timeNow, 15)</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                        <span class="comment"># self.pop_up(obstacle3, timeNow, 10)</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                        <span class="comment"># self.objPub.publish(return_object_array())</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                        self.<a class="code" href="classfake__obstacle_1_1FakeObstacleNode.html#afbcab1ee35760168a9ff7b708117e7f3">objPub</a>.publish(fakeObstacles.update_objects(timeNow))</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                        rate.sleep()</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="keywordflow">if</span> __name__==<span class="stringliteral">&quot;__main__&quot;</span>:</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        rospy.init_node(<span class="stringliteral">&quot;fake_obstacle_detect&quot;</span>)</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="comment"># Create some fake obstacles to be stored in ObjectDetect Array</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="comment"># type_ (str): &quot;MLR&quot;, &quot;MUD&quot;, &quot;ST&quot;, &quot;POP&quot; (not part of the messages!)</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="comment"># arguments: easting, northing, id, bb_height, bb_width, obj_confidence</span></div><div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="namespacefake__obstacle.html#a428790d1382ac31d37afe8868b31ba70">  199</a></span>&#160;        obstacle1 = FakeObstacles.add_obstacles(100, -80, 134, 25, 25, 1, <span class="stringliteral">&quot;MLR&quot;</span>, period=10, amplitude=25)     <span class="comment"># Moving left/right</span></div><div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="namespacefake__obstacle.html#a2524fd13792100ea9d110f5cc27e9779">  200</a></span>&#160;        obstacle2 = FakeObstacles.add_obstacles(480, 119, 2, 10, 10, 1, <span class="stringliteral">&quot;MUD&quot;</span>, period=10, amplitude=25)        <span class="comment"># Moving up/down</span></div><div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="namespacefake__obstacle.html#af386310e38ced0224b7d6d636088181c">  201</a></span>&#160;        obstacle3 = FakeObstacles.add_obstacles(110, -80, 10, 20, 20, 1, <span class="stringliteral">&quot;ST&quot;</span>)      <span class="comment"># Stationary / POP-UP</span></div><div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="namespacefake__obstacle.html#a660d0488535e0d38632ded24b0512ff0">  202</a></span>&#160;        obstacle4 = FakeObstacles.add_obstacles(80, -80, 11, 20, 20, 1, <span class="stringliteral">&quot;POP&quot;</span>, tAppear=5)      <span class="comment"># Stationary / POP-UP</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="comment"># Create Node instance, pass in Class of FakeObstacles</span></div><div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="namespacefake__obstacle.html#a65a0a931643d7fdec7749e1b9b174917">  205</a></span>&#160;        fod = <a class="code" href="classfake__obstacle_1_1FakeObstacleNode.html">FakeObstacleNode</a>(FakeObstacles)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        rospy.spin()</div><div class="ttc" id="classfake__obstacle_1_1FakeObstacles_html"><div class="ttname"><a href="classfake__obstacle_1_1FakeObstacles.html">fake_obstacle.FakeObstacles</a></div><div class="ttdef"><b>Definition:</b> <a href="fake__obstacle_8py_source.html#l00012">fake_obstacle.py:12</a></div></div>
<div class="ttc" id="classfake__obstacle_1_1FakeObstacleNode_html_a85cf0f3e284aa663868e1acd3dd7b999"><div class="ttname"><a href="classfake__obstacle_1_1FakeObstacleNode.html#a85cf0f3e284aa663868e1acd3dd7b999">fake_obstacle.FakeObstacleNode.__init__</a></div><div class="ttdeci">def __init__(self, fakeObstacles, topic_name=&quot;/test/object_detection&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="fake__obstacle_8py_source.html#l00171">fake_obstacle.py:171</a></div></div>
<div class="ttc" id="classfake__obstacle_1_1FakeObstacles_html_adfbd206d9166bbbd6b1691ed596f913c"><div class="ttname"><a href="classfake__obstacle_1_1FakeObstacles.html#adfbd206d9166bbbd6b1691ed596f913c">fake_obstacle.FakeObstacles.objectArrayDict</a></div><div class="ttdeci">dictionary objectArrayDict</div><div class="ttdef"><b>Definition:</b> <a href="fake__obstacle_8py_source.html#l00021">fake_obstacle.py:21</a></div></div>
<div class="ttc" id="classfake__obstacle_1_1FakeObstacles_html_a3bc0716dd29c3064e86bd463710dc38c"><div class="ttname"><a href="classfake__obstacle_1_1FakeObstacles.html#a3bc0716dd29c3064e86bd463710dc38c">fake_obstacle.FakeObstacles.pop_up</a></div><div class="ttdeci">def pop_up(cls, f_obstacle, t, tAppear=None)</div><div class="ttdef"><b>Definition:</b> <a href="fake__obstacle_8py_source.html#l00123">fake_obstacle.py:123</a></div></div>
<div class="ttc" id="classfake__obstacle_1_1FakeObstacleNode_html_afbcab1ee35760168a9ff7b708117e7f3"><div class="ttname"><a href="classfake__obstacle_1_1FakeObstacleNode.html#afbcab1ee35760168a9ff7b708117e7f3">fake_obstacle.FakeObstacleNode.objPub</a></div><div class="ttdeci">objPub</div><div class="ttdef"><b>Definition:</b> <a href="fake__obstacle_8py_source.html#l00174">fake_obstacle.py:174</a></div></div>
<div class="ttc" id="classfake__obstacle_1_1FakeObstacles_html_ae8861060d762f4b351bedc1e49e7a435"><div class="ttname"><a href="classfake__obstacle_1_1FakeObstacles.html#ae8861060d762f4b351bedc1e49e7a435">fake_obstacle.FakeObstacles.update_objects</a></div><div class="ttdeci">def update_objects(cls, time)</div><div class="ttdef"><b>Definition:</b> <a href="fake__obstacle_8py_source.html#l00084">fake_obstacle.py:84</a></div></div>
<div class="ttc" id="classfake__obstacle_1_1FakeObstacles_html_a3877a418deb713aa4efcd37cdb9cee74"><div class="ttname"><a href="classfake__obstacle_1_1FakeObstacles.html#a3877a418deb713aa4efcd37cdb9cee74">fake_obstacle.FakeObstacles.use_motion_model_y</a></div><div class="ttdeci">def use_motion_model_y(obstacle, t, period=None, amplitude=None)</div><div class="ttdef"><b>Definition:</b> <a href="fake__obstacle_8py_source.html#l00114">fake_obstacle.py:114</a></div></div>
<div class="ttc" id="classfake__obstacle_1_1FakeObstacleNode_html"><div class="ttname"><a href="classfake__obstacle_1_1FakeObstacleNode.html">fake_obstacle.FakeObstacleNode</a></div><div class="ttdef"><b>Definition:</b> <a href="fake__obstacle_8py_source.html#l00160">fake_obstacle.py:160</a></div></div>
<div class="ttc" id="classfake__obstacle_1_1FakeObstacles_html_a3c40447c05bf3f0b66600278575fdadc"><div class="ttname"><a href="classfake__obstacle_1_1FakeObstacles.html#a3c40447c05bf3f0b66600278575fdadc">fake_obstacle.FakeObstacles.add_obstacles</a></div><div class="ttdeci">def add_obstacles(cls, easting, northing, id, bb_height, bb_width, obj_confidence, type_, kwargs)</div><div class="ttdef"><b>Definition:</b> <a href="fake__obstacle_8py_source.html#l00051">fake_obstacle.py:51</a></div></div>
<div class="ttc" id="classfake__obstacle_1_1FakeObstacles_html_a3831a191cf1cc8a1edf95b67dac41903"><div class="ttname"><a href="classfake__obstacle_1_1FakeObstacles.html#a3831a191cf1cc8a1edf95b67dac41903">fake_obstacle.FakeObstacles.return_object_array</a></div><div class="ttdeci">def return_object_array(cls)</div><div class="ttdef"><b>Definition:</b> <a href="fake__obstacle_8py_source.html#l00151">fake_obstacle.py:151</a></div></div>
<div class="ttc" id="classfake__obstacle_1_1FakeObstacles_html_ad4c5a91714247afb01b02cd30e2bd8e2"><div class="ttname"><a href="classfake__obstacle_1_1FakeObstacles.html#ad4c5a91714247afb01b02cd30e2bd8e2">fake_obstacle.FakeObstacles._add_obstacles</a></div><div class="ttdeci">def _add_obstacles(cls, id, object, type_, init_e, init_n, kwargs)</div><div class="ttdef"><b>Definition:</b> <a href="fake__obstacle_8py_source.html#l00080">fake_obstacle.py:80</a></div></div>
<div class="ttc" id="classfake__obstacle_1_1FakeObstacles_html_a03901b0c226c1ef5cc7ee11146ac0571"><div class="ttname"><a href="classfake__obstacle_1_1FakeObstacles.html#a03901b0c226c1ef5cc7ee11146ac0571">fake_obstacle.FakeObstacles.use_motion_model_x</a></div><div class="ttdeci">def use_motion_model_x(obstacle, t, period=None, amplitude=None)</div><div class="ttdef"><b>Definition:</b> <a href="fake__obstacle_8py_source.html#l00107">fake_obstacle.py:107</a></div></div>
</div><!-- fragment --></div><!-- contents -->

<br clear="all" />
<hr size="1"><div style="align: right;">
<a href="http://wiki.ros.org/tamu_sa">tamu_sa</a><br />
Author(s): </br />
<small>autogenerated on Wed Aug 19 2020 14:36:44</small>
</div>
</body>
</html>
